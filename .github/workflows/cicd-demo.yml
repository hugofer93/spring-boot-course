# =============================================================================
# CI/CD de demostraciÃ³n - Curso Spring Boot
# =============================================================================
# Este workflow es didÃ¡ctico: sirve para ver en GitHub Actions cÃ³mo se ejecuta
# un pipeline al hacer push o abrir un Pull Request.
#
# DÃ³nde ver la ejecuciÃ³n: Repo â†’ pestaÃ±a "Actions" â†’ elegir una ejecuciÃ³n.
# =============================================================================

name: ðŸŽ“ CI/CD Demo

# CuÃ¡ndo se ejecuta
on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  demo:
    name: Pipeline de demostraciÃ³n
    runs-on: ubuntu-latest

    steps:
      # --- Paso 1: Obtener el cÃ³digo del repositorio ---
      - name: ðŸ“¥ Descargar cÃ³digo (Checkout)
        uses: actions/checkout@v4

      # --- Paso 2: Configurar Java (como en un proyecto real) ---
      - name: â˜• Configurar Java 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: maven

      # --- Paso 3: Paso demostrativo (podÃ©is ver este output en los logs) ---
      - name: ðŸ‘‹ Paso demostrativo
        run: |
          echo "=========================================="
          echo "  Â¡El pipeline se estÃ¡ ejecutando!"
          echo "  Repo: ${{ github.repository }}"
          echo "  Rama: ${{ github.ref_name }}"
          echo "  Commit: ${{ github.sha }}"
          echo "=========================================="
          java -version

      # --- Paso 4: Compilar y ejecutar tests de un proyecto del curso ---
      - name: ðŸ”¨ Compilar y ejecutar tests (proyecto 3.10-cicd)
        run: mvn -B -f 3.10-cicd/cicd-project/pom.xml clean verify

      # --- Paso 5: Resumen visible en los logs ---
      - name: âœ… Resumen
        if: success()
        run: |
          echo "Pipeline completado correctamente."
          echo "Revisa la pestaÃ±a Actions en GitHub para ver todos los pasos."
